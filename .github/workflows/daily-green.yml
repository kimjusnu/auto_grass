name: ğŸŒ± ìë™ ì”ë”” ì‹¬ê¸°

on:
  schedule:
    # ë§¤ì¼ KST 08:00 = UTC 23:00 (ì „ë‚ )
    - cron: "0 23 * * *"
  workflow_dispatch: {}

permissions:
  contents: write # GITHUB_TOKENìœ¼ë¡œ í‘¸ì‹œí•˜ë ¤ë©´ ì´ê±° í•„ìˆ˜

jobs:
  seed:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      # ë°©ë²• A) íŒŒì¼ì— íƒ€ì„ìŠ¤íƒ¬í”„ í•œ ì¤„ ì¶”ê°€
      - name: Update heartbeat file
        run: |
          mkdir -p .github

          # ê¸°ì¡´ íŒŒì¼ì´ ìˆìœ¼ë©´ ë¼ì¸ ìˆ˜ë¥¼ ì„¸ì–´ì„œ ì¼ìˆ˜ ê³„ì‚°
          if [ -f .github/reminder.txt ]; then
            DAY_COUNT=$(wc -l < .github/reminder.txt)
            DAY_COUNT=$((DAY_COUNT + 1))
          else
            DAY_COUNT=1
          fi

          echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ') - ğŸŒ± ì”ë”” ì‹¬ê¸° ${DAY_COUNT}ì¼ì°¨" >> .github/reminder.txt
          git config user.name "github-actions[bot]"
          git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
          git add .github/reminder.txt
          git commit -m "feat: ì”ë”” ì‹¬ê¸° ${DAY_COUNT}ì¼ì°¨ - $(date +'%Yë…„ %mì›” %dì¼')" || echo "ë³€ê²½ì‚¬í•­ ì—†ìŒ"
          git push

      # ë°©ë²• B) ë ˆí¬ë¥¼ ë”ëŸ½íˆê¸° ì‹«ìœ¼ë©´ ë¹ˆ ì»¤ë°‹ìœ¼ë¡œë„ ê°€ëŠ¥
      # - name: Empty commit (alternative)
      #   run: |
      #     git config user.name "github-actions[bot]"
      #     git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
      #
      #     # ì»¤ë°‹ íˆìŠ¤í† ë¦¬ì—ì„œ ì¼ìˆ˜ ê³„ì‚°
      #     COMMIT_COUNT=$(git rev-list --count HEAD)
      #     DAY_COUNT=$((COMMIT_COUNT + 1))
      #
      #     git commit --allow-empty -m "feat: ì”ë”” ì‹¬ê¸° ${DAY_COUNT}ì¼ì°¨ (ë¹ˆ ì»¤ë°‹) - $(date +'%Yë…„ %mì›” %dì¼')"
      #     git push
